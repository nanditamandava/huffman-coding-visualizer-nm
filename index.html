<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>huffman coding visualizer üêå</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+Pica:ital@1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- react + framer motion (for animated tree rendering) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.umd.js"></script>
</head>
<body>
    <div class="container-fluid mt-4 px-4">
        <h1 id="main-title" class="text-center mb-4">huffman coding visualizer</h1>
        <br>
        <br>
        
        <div class="row mb-4 justify-content-center">
            <div class="col-md-6 col-lg-5 col-xl-4 mx-auto">
                <div class="card">
                    <div class="card-header">
                        <ul class="nav nav-tabs card-header-tabs" id="inputTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="manual-tab" data-bs-toggle="tab" data-bs-target="#manual" type="button" role="tab">manual input</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="text-tab" data-bs-toggle="tab" data-bs-target="#text" type="button" role="tab">text analysis</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="sample-tab" data-bs-toggle="tab" data-bs-target="#sample" type="button" role="tab">sample data</button>
                            </li>
                        </ul>
                    </div>
                    <div class="card-body">
                        <div class="tab-content" id="inputTabsContent">
                            <div class="tab-pane fade show active" id="manual" role="tabpanel">
                                <div id="manual-inputs">
                                    <div class="input-group mb-2">
                                        <input type="text" class="form-control char-input" placeholder="character" maxlength="1">
                                        <input type="number" class="form-control freq-input" placeholder="frequency" min="1">
                                        <button class="btn btn-outline-danger remove-btn" type="button">√ó</button>
                                    </div>
                                </div>
                                <button id="add-row" class="btn btn-secondary btn-sm mt-2">+ add character</button>
                            </div>
                            <div class="tab-pane fade" id="text" role="tabpanel">
                                <textarea id="text-input" class="form-control" rows="5" placeholder="enter text to analyze..."></textarea>
                            </div>
                            <div class="tab-pane fade" id="sample" role="tabpanel">
                                <select id="sample-select" class="form-select">
                                    <option value="sample1"> </option>
                                    <option value="sample1">sample 1: basic (A:5, B:9, C:12, D:13, E:16, F:45)</option>
                                    <option value="sample2">sample 2: vowels (A:8, E:12, I:7, O:7, U:3)</option>
                                    <option value="sample3">sample 3: binary (0:1, 1:3, 2:4, 3:2)</option>
                                </select>
                            </div>
                        </div>
                        <button id="build-tree" type="button" class="btn btn-primary mt-3 w-100">build huffman tree</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tree page header (shown when tree is visible) -->
        <h1 id="tree-page-title" class="text-center mb-4 section-hidden" style="font-family: 'IM Fell Pica', serif; font-style: italic; font-size: 3.85rem; margin-top: -1.5rem;">huffman coding visualizer</h1>

        <!-- Tree page layout: left sidebar + right tree -->
        <div id="tree-page-container" class="row section-hidden" style="margin-top: 1rem;">
            <!-- Left sidebar: controls, steps, codes -->
            <div class="col-12 col-lg-4 d-flex flex-column gap-3">
                <!-- Controls card -->
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span>controls</span>
                        <div class="form-check form-switch m-0">
                            <input class="form-check-input" type="checkbox" id="toggle-gingham" checked>
                            <label class="form-check-label" for="toggle-gingham">gingham bg</label>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="d-flex align-items-center gap-2">
                            <div class="btn-group btn-group-sm flex-grow-1" role="group">
                                <button id="back-btn" class="btn btn-outline-secondary fw-bold">prev</button>
                                <button id="step-btn" class="btn btn-outline-primary fw-bold">next</button>
                                <button id="play-btn" class="btn btn-outline-success fw-bold">play</button>
                                <button id="reset-btn" class="btn btn-outline-danger fw-bold">reset</button>
                            </div>
                            <div class="btn-group btn-group-sm" role="group" style="flex-shrink: 0;">
                                <button id="speed-decrease" class="btn btn-outline-primary" type="button" style="width: 30px; min-width: 30px; padding: 0.25rem 0;">‚àí</button>
                                <button id="speed-display" class="btn btn-primary" type="button" disabled style="width: 60px; min-width: 60px; padding: 0.25rem 0.25rem;">1.00√ó</button>
                                <button id="speed-increase" class="btn btn-outline-primary" type="button" style="width: 30px; min-width: 30px; padding: 0.25rem 0;">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Algorithm steps card -->
                <div class="card">
                    <div class="card-header">algorithm steps</div>
                    <div class="card-body d-flex flex-column" style="max-height: 350px; overflow-y: auto;">
                        <div id="pq-panel" class="pq-panel mb-2 section-hidden"></div>
                        <div id="steps" class="steps-container flex-grow-1 w-100"></div>
                        <div id="next-merge-box" class="next-merge-box section-hidden mt-2"></div>
                    </div>
                </div>

                <!-- Huffman codes card -->
                <div id="codes-card" class="card">
                    <div class="card-header">huffman codes</div>
                    <div class="card-body" style="display:flex;flex-direction:column;gap:8px;max-height:450px;overflow-y:auto;">
                        <div id="codes-metrics" style="font-weight:700;color:#5a4a3a;display:flex;flex-direction:column;gap:6px;font-size:0.9rem;">
                            <div>ASCII 8-bit encoded length: <span id="codes-metrics-orig" style="font-weight:800;">‚Äì</span> bits</div>
                            <div><span id="encoding-type-label">Variable Huffman</span> encoding size: <span id="codes-metrics-est" style="font-weight:800;">‚Äì</span> bits</div>
                            <div>Savings: <span id="codes-metrics-savings" style="font-weight:800;">‚Äì</span></div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-sm align-middle" style="font-size: 0.85rem;">
                                <thead>
                                    <tr>
                                        <th>character</th>
                                        <th>frequency</th>
                                        <th id="code-header">huffman code</th>
                                        <th>total bits</th>
                                    </tr>
                                </thead>
                                <tbody id="codes-table"></tbody>
                            </table>
                        </div>
                        <button id="toggle-encoding" class="btn btn-outline-primary btn-sm">fixed length</button>
                    </div>
                </div>
            </div>

            <!-- Right: Tree visualizer (takes up more space) -->
            <div class="col-12 col-lg-8 d-flex">
                <div class="card flex-grow-1">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span>huffman tree visualization</span>
                        <div class="d-flex align-items-center gap-2">
                            <div class="form-check form-switch me-2">
                                <input class="form-check-input" type="checkbox" id="show-weights" checked>
                                <label class="form-check-label" for="show-weights">show weights</label>
                            </div>
                            <div class="btn-group btn-group-sm me-2" role="group">
                                <button id="zoom-out" class="btn btn-secondary" type="button" title="Zoom Out" style="color: white; padding: 0.25rem 0.4rem;">‚àí</button>
                                <button id="zoom-reset" class="btn btn-secondary" type="button" title="Reset Zoom" style="color: white; padding: 0.25rem 0.5rem; min-width: 50px;">100%</button>
                                <button id="zoom-in" class="btn btn-secondary" type="button" title="Zoom In" style="color: white; padding: 0.25rem 0.4rem;">+</button>
                            </div>
                            <button id="export-png" class="btn btn-outline-primary btn-sm" type="button">export png</button>
                            <button id="switch-to-input" class="btn btn-secondary btn-sm" type="button">back to input</button>
                            <script>
                              // Reset the tool when clicking "back to input"
                              document.addEventListener("DOMContentLoaded", function() {
                                const backBtn = document.getElementById("switch-to-input");
                                if (backBtn) {
                                  backBtn.addEventListener("click", function() {
                                    location.reload(); // reloads the page as if freshly opened
                                  });
                                }
                              });
                            </script>
                        </div>
                    </div>
                    <div class="card-body" style="overflow: auto; max-height: calc(100vh - 180px);">
                        <div id="tree-container">
                            <!-- Legacy D3 SVG kept for compatibility; we'll clear it and render via React below -->
                            <svg id="tree-svg" width="100%" height="600" style="display: block;"></svg>
                            <!-- React mount root for Framer Motion tree -->
                            <div id="tree-react-root"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
    </div>

    <!-- In-page export overlay -->
    <div id="export-overlay" class="export-overlay section-hidden"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- C++ WebAssembly module (compiled from huffman.cpp) -->
    <script src="huffman.js"></script>
    <!-- JavaScript bridge layer (provides compatibility with visualizer.js) -->
    <script src="huffman-bridge.js"></script>
    <!-- React-based tree renderer using Framer Motion -->
    <script src="tree-renderer.js"></script>
    <script src="visualizer.js"></script>
</body>
</html>
